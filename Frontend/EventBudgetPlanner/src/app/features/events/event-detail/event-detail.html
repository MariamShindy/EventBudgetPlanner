<!-- <div class="event-detail-container" *ngIf="!isLoading && event; else loadingTemplate">
  <header>
    <div>
      <h2>{{ event?.name }}</h2>
      <p>{{ event?.date | date: 'fullDate' }}</p>
    </div>
    <div class="header-actions">
      <button class="btn secondary" (click)="shareToWhatsApp()">Share Event</button>
      <button class="btn primary" (click)="editEvent()">Edit Event</button>
      <button class="btn danger" (click)="deleteEvent()">Delete Event</button>
    </div>
  </header>

  <section class="event-info">
    <div class="card">
      <h3>Budget Info</h3>
      <div class="info-grid">
        <div>
          <label>Total Budget</label>
          <span>{{ event?.budget | currency }}</span>
        </div>
        <div>
          <label>Created</label>
          <span>{{ event?.createdDate | date: 'short' }}</span>
        </div>
        <div>
          <label>Description</label>
          <span>{{ event?.description || 'No description provided.' }}</span>
        </div>
      </div>
    </div>

    <div class="card" *ngIf="summary">
      <h3>Summary</h3>
      <div class="summary-grid">
        <div>
          <label>Total Spent</label>
          <span>{{ summary.totalSpent | currency }}</span>
        </div>
        <div>
          <label>Remaining</label>
          <span>{{ summary.remainingBudget | currency }}</span>
        </div>
        <div>
          <label>Spent (%)</label>
          <span>{{ summary.percentageSpent | number: '1.0-2' }}%</span>
        </div>
        <div>
          <label>Expenses</label>
          <span>{{ summary.totalExpensesCount }} total</span>
        </div>
      </div>
      <div class="categories">
        <h4>Expenses by Category</h4>
        <div class="category" *ngFor="let category of summary.expensesByCategory | keyvalue">
          <span>{{ category.key }}</span>
          <strong>{{ category.value | currency }}</strong>
        </div>
      </div>
    </div>

    <div class="card" *ngIf="cashflow">
      <h3>Cashflow ({{ cashflow.interval | titlecase }})</h3>
      <div class="cashflow">
        <div class="point" *ngFor="let point of cashflow.points">
          <div>
            <label>{{ point.periodStart | date: 'MMM d' }} - {{ point.periodEnd | date: 'MMM d' }}</label>
            <span>{{ point.total | currency }}</span>
          </div>
          <small>Cumulative: {{ point.cumulative | currency }}</small>
        </div>
      </div>
    </div>

    <div class="card" *ngIf="shareLink">
      <h3>Share Link</h3>
      <p>{{ shareLink }}</p>
    </div>

    <div class="card">
      <div class="card-header">
        <h3>Expenses</h3>
        <button class="btn primary" (click)="router.navigate(['/events', event.id, 'expenses', 'create'])">
          Add Expense
        </button>
      </div>

      <div class="expense-filters">
        <select [(ngModel)]="expenseFilter.paid" (change)="filterExpenses()">
          <option [ngValue]="null">All Payment Status</option>
          <option [ngValue]="true">Paid</option>
          <option [ngValue]="false">Unpaid</option>
        </select>
        <input 
          type="text" 
          [(ngModel)]="expenseFilter.category" 
          (input)="filterExpenses()"
          placeholder="Filter by category">
        <button class="btn secondary" (click)="clearExpenseFilters()">Clear Filters</button>
      </div>

      <div *ngIf="expensesLoading" class="loading">Loading expenses...</div>
      <div *ngIf="!expensesLoading && filteredExpenses.length === 0" class="empty-state">
        <p>No expenses found. Add your first expense to get started!</p>
      </div>
      <div class="expenses-list" *ngIf="!expensesLoading && filteredExpenses.length > 0">
        <div class="expense-item" *ngFor="let expense of filteredExpenses">
          <div class="expense-info">
            <div class="expense-main">
              <h4>{{ expense.category }}</h4>
            </div>
            <span class="expense-amount">{{ expense.amount | currency }}</span>
            <div class="expense-details">
              <p *ngIf="expense.description">{{ expense.description }}</p>
              <small>{{ expense.date | date: 'short' }}</small>
            </div>
          </div>
          <div class="expense-actions">
            <label class="paid-toggle">
              <input 
                type="checkbox" 
                [checked]="expense.paid"
                (change)="toggleExpensePaidStatus(expense)">
              <span>{{ expense.paid ? 'Paid' : 'Unpaid' }}</span>
            </label>
            <button class="btn secondary" (click)="router.navigate(['/events', event.id, 'expenses', expense.id, 'edit'])">
              Edit
            </button>
            <button class="btn danger" (click)="deleteExpense(expense.id)">Delete</button>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <h3>Email Reminders</h3>
        <button class="btn secondary" (click)="showReminderForm = !showReminderForm">
          {{ showReminderForm ? 'Cancel' : 'Send Reminder' }}
        </button>
      </div>

      <div *ngIf="reminderSuccess" class="success-message">
        Reminder sent successfully!
      </div>

      <form *ngIf="showReminderForm" (ngSubmit)="sendReminder()" class="reminder-form">
        <div class="form-group">
          <label>Email Address</label>
          <input 
            type="email" 
            [(ngModel)]="reminderForm.email" 
            name="email"
            required
            placeholder="recipient@example.com">
        </div>
        <div class="form-group">
          <label>Days Before Event</label>
          <input 
            type="number" 
            [(ngModel)]="reminderForm.daysBeforeEvent" 
            name="daysBeforeEvent"
            min="1"
            required>
        </div>
        <div class="form-group">
          <label>Custom Message (Optional)</label>
          <textarea 
            [(ngModel)]="reminderForm.customMessage" 
            name="customMessage"
            rows="3"
            placeholder="Add a custom message to the reminder email"></textarea>
        </div>
        <button type="submit" class="btn primary">Send Reminder</button>
      </form>
    </div>
  </section>
</div>

<ng-template #loadingTemplate>
  <div class="loading">Loading event...</div>
</ng-template> -->

<div class="event-detail-container" *ngIf="!isLoading && event; else loadingTemplate">
  <header>
    <div class="header-left">
      <div class="back-button" routerLink="/events">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 4l-6 6 6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div>
        <h2>{{ event?.name }}</h2>
        <div class="header-meta">
          <div class="meta-item">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="2" y="3" width="12" height="11" rx="2" stroke="currentColor" stroke-width="1.5"/>
              <path d="M2 6h12M5 2v2M11 2v2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>{{ event?.date | date: 'fullDate' }}</span>
          </div>
          <div class="meta-item">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
              <path d="M8 4v4l3 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>Created {{ event?.createdDate | date: 'MMM d, y' }}</span>
          </div>
        </div>
      </div>
    </div>
    <div class="header-actions">
      <button class="btn secondary" (click)="shareToWhatsApp()">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 5l-4 4-4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Share
      </button>
      <button class="btn primary" (click)="editEvent()">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M11.3 2.3l2.4 2.4L6 12.4 2 13l.6-4 7.7-7.7z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Edit
      </button>
      <button class="btn danger" (click)="deleteEvent()">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 4h10M6 4V3h4v1M6 7v5M10 7v5M4 4h8l-.5 9H4.5L4 4z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
        Delete
      </button>
    </div>
  </header>

  <section class="event-info">
    <!-- Budget Overview Card -->
    <div class="card budget-card">
      <div class="card-icon budget">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/>
          <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <h3>Budget Overview</h3>
      <div class="info-grid">
        <div class="info-item">
          <label>Total Budget</label>
          <span class="highlight budget-total">{{ event?.budget | currency }}</span>
        </div>
        <div class="info-item" *ngIf="summary">
          <label>Total Spent</label>
          <span class="highlight spent">{{ summary.totalSpent | currency }}</span>
        </div>
        <div class="info-item" *ngIf="summary">
          <label>Remaining</label>
          <span class="highlight remaining">{{ summary.remainingBudget | currency }}</span>
        </div>
        <div class="info-item" *ngIf="summary">
          <label>Spent Percentage</label>
          <div class="progress-wrapper">
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="summary.percentageSpent"></div>
            </div>
            <span class="progress-label">{{ summary.percentageSpent | number: '1.0-1' }}%</span>
          </div>
        </div>
      </div>
      <div class="description-section" *ngIf="event?.description">
        <label>Description</label>
        <p>{{ event?.description }}</p>
      </div>
    </div>

    <!-- Categories Breakdown -->
    <div class="card" *ngIf="summary && summary.expensesByCategory">
      <div class="card-icon categories">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="3" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/>
          <rect x="14" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/>
          <rect x="3" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/>
          <rect x="14" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/>
        </svg>
      </div>
      <h3>Expenses by Category</h3>
      <div class="categories-grid">
        <div class="category-item" *ngFor="let category of summary.expensesByCategory | keyvalue">
          <div class="category-header">
            <span class="category-name">{{ category.key }}</span>
            <span class="category-amount">{{ category.value | currency }}</span>
          </div>
          <div class="category-bar">
            <div class="category-fill" [style.width.%]="(category.value / summary.totalSpent) * 100"></div>
          </div>
        </div>
      </div>
      <div class="summary-stats">
        <div class="stat">
          <label>Total Expenses</label>
          <span>{{ summary.totalExpensesCount }}</span>
        </div>
      </div>
    </div>

    <!-- Cashflow Card -->
    <div class="card" *ngIf="cashflow">
      <div class="card-icon cashflow">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 12h18M3 6h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <h3>Cashflow Timeline</h3>
      <div class="interval-badge">{{ cashflow.interval | titlecase }}</div>
      <div class="cashflow-timeline">
        <div class="cashflow-point" *ngFor="let point of cashflow.points; let i = index">
          <div class="point-indicator">
            <div class="point-dot"></div>
            <div class="point-line" *ngIf="i < cashflow.points.length - 1"></div>
          </div>
          <div class="point-content">
            <div class="point-header">
              <label>{{ point.periodStart | date: 'MMM d' }} - {{ point.periodEnd | date: 'MMM d' }}</label>
              <span class="point-amount">{{ point.total | currency }}</span>
            </div>
            <small>Cumulative: {{ point.cumulative | currency }}</small>
          </div>
        </div>
      </div>
    </div>

    <!-- Share Link Card -->
    <div class="card share-card" *ngIf="shareLink">
      <div class="card-icon share">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="18" cy="5" r="3" stroke="currentColor" stroke-width="2"/>
          <circle cx="6" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
          <circle cx="18" cy="19" r="3" stroke="currentColor" stroke-width="2"/>
          <path d="M8.5 13.5l7 4M8.5 10.5l7-4" stroke="currentColor" stroke-width="2"/>
        </svg>
      </div>
      <h3>Share Link</h3>
      <div class="share-link-container">
        <input type="text" readonly [value]="shareLink" class="share-link-input">
        <button class="btn secondary copy-btn" (click)="shareToWhatsApp()">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="5" y="5" width="9" height="9" rx="1" stroke="currentColor" stroke-width="1.5"/>
            <path d="M3 11V3a1 1 0 0 1 1-1h8" stroke="currentColor" stroke-width="1.5"/>
          </svg>
          Copy
        </button>
      </div>
    </div>

    <!-- Expenses Section -->
    <div class="card expenses-card">
      <div class="card-header">
        <div class="card-title-group">
          <div class="card-icon expenses">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="3" y="6" width="18" height="13" rx="2" stroke="currentColor" stroke-width="2"/>
              <path d="M7 6V5a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1M12 11v3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <h3>Expenses</h3>
        </div>
        <button class="btn primary" (click)="router.navigate(['/events', event.id, 'expenses', 'create'])">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M8 2v12M2 8h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Add Expense
        </button>
      </div>

      <!-- Expense Filters -->
      <div class="expense-filters">
        <div class="filter-group">
          <label>Payment Status</label>
          <select [(ngModel)]="expenseFilter.paid" (change)="filterExpenses()">
            <option [ngValue]="null">All Status</option>
            <option [ngValue]="true">Paid</option>
            <option [ngValue]="false">Unpaid</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Category</label>
          <input 
            type="text" 
            [(ngModel)]="expenseFilter.category" 
            (input)="filterExpenses()"
            placeholder="Search category...">
        </div>
        <button class="btn secondary clear-filters" (click)="clearExpenseFilters()">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 4L4 12M4 4l8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Clear
        </button>
      </div>

      <!-- Expenses List -->
      <div *ngIf="expensesLoading" class="loading-expenses">
        <div class="spinner"></div>
        <p>Loading expenses...</p>
      </div>
      
      <div *ngIf="!expensesLoading && filteredExpenses.length === 0" class="empty-state">
        <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="12" y="20" width="40" height="28" rx="3" stroke="#D1D5DB" stroke-width="2"/>
          <path d="M20 20V18a2 2 0 0 1 2-2h20a2 2 0 0 1 2 2v2M32 30v8" stroke="#D1D5DB" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <h4>No expenses found</h4>
        <p>Add your first expense to get started tracking your event budget!</p>
      </div>
      
      <div class="expenses-list" *ngIf="!expensesLoading && filteredExpenses.length > 0">
        <div class="expense-item" *ngFor="let expense of filteredExpenses">
          <div class="expense-left">
            <div class="expense-category-icon" [class.paid]="expense.paid">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 10l3 3 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" *ngIf="expense.paid"/>
                <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" *ngIf="!expense.paid"/>
              </svg>
            </div>
            <div class="expense-info">
              <div class="expense-main">
                <h4>{{ expense.category }}</h4>
                <span class="expense-status" [class.paid]="expense.paid">
                  {{ expense.paid ? 'Paid' : 'Unpaid' }}
                </span>
              </div>
              <div class="expense-details">
                <p *ngIf="expense.description">{{ expense.description }}</p>
                <small>
                  <svg width="12" height="12" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
                    <path d="M8 4v4l3 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  {{ expense.date | date: 'MMM d, y \'at\' h:mm a' }}
                </small>
              </div>
            </div>
          </div>
          <div class="expense-right">
            <span class="expense-amount">{{ expense.amount | currency }}</span>
            <div class="expense-actions">
              <label class="paid-toggle">
                <input 
                  type="checkbox" 
                  [checked]="expense.paid"
                  (change)="toggleExpensePaidStatus(expense)">
                <span class="toggle-slider"></span>
              </label>
              <button class="btn-icon" (click)="router.navigate(['/events', event.id, 'expenses', expense.id, 'edit'])" title="Edit">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M11.3 2.3l2.4 2.4L6 12.4 2 13l.6-4 7.7-7.7z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <button class="btn-icon danger" (click)="deleteExpense(expense.id)" title="Delete">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M3 4h10M6 4V3h4v1M6 7v5M10 7v5M4 4h8l-.5 9H4.5L4 4z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Email Reminder Section -->
    <div class="card reminder-card">
      <div class="card-header">
        <div class="card-title-group">
          <div class="card-icon reminder">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <h3>Email Reminders</h3>
        </div>
        <button class="btn secondary" (click)="showReminderForm = !showReminderForm">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" *ngIf="!showReminderForm">
            <path d="M8 2v12M2 8h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" *ngIf="showReminderForm">
            <path d="M12 4L4 12M4 4l8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          {{ showReminderForm ? 'Cancel' : 'Send Reminder' }}
        </button>
      </div>

      <div *ngIf="reminderSuccess" class="success-message">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2"/>
          <path d="M6 10l3 3 5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Reminder sent successfully!
      </div>

      <form *ngIf="showReminderForm" (ngSubmit)="sendReminder()" class="reminder-form">
        <div class="form-row">
          <div class="form-group">
            <label>Email Address</label>
            <input 
              type="email" 
              [(ngModel)]="reminderForm.email" 
              name="email"
              required
              placeholder="recipient@example.com">
          </div>
          <div class="form-group">
            <label>Days Before Event</label>
            <input 
              type="number" 
              [(ngModel)]="reminderForm.daysBeforeEvent" 
              name="daysBeforeEvent"
              min="1"
              required
              placeholder="7">
          </div>
        </div>
        <div class="form-group">
          <label>Custom Message (Optional)</label>
          <textarea 
            [(ngModel)]="reminderForm.customMessage" 
            name="customMessage"
            rows="4"
            placeholder="Add a custom message to include in the reminder email..."></textarea>
        </div>
        <button type="submit" class="btn primary">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2 2l12 6-12 6V9l9-1-9-1V2z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Send Reminder
        </button>
      </form>
    </div>
  </section>
</div>

<ng-template #loadingTemplate>
  <div class="loading-container">
    <div class="spinner"></div>
    <p>Loading event details...</p>
  </div>
</ng-template>

